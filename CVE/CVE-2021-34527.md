# CVE-2021-34527  - Print nightmare :

## Qu’est ce que s’est ? 

Bilan sécurité : CVE-2021-34527 

Il s’agit d’une une faille 0 day affectant les spooler d’impression Windows. Cette faille  affecte les serveurs exécutant Windows 7 et les versions ultérieures.

## Quel est le risque de cette faille ? 
 
L’exploit de cette faille permet d’exécuter du code à distance afin de faire une élévation de privilèges de niveau système, pour tout utilisateur ayant un compte sur l’Active Directory. 

Un attaquant pourrait installer un programme, afficher, modifier, supprimer des données ou créer un nouveau compte avec tous les privilèges administrateur. Tout cela en passant par l’exécution de fichier DLL.

Ce service étant activé par défaut, tout système Windows est potentiellement vulnérable.

## Comment ça marche

Le print spooler service a une fonction appelée RpcAddPrinterDrive, qui permet aux utilisateurs d'ajouter des pilotes à un print spooler distant ; cette activité est normale et est conçue pour permettre aux administrateurs informatiques d'installer à distance des pilotes d'imprimante dans un environnement de bureau. Cependant, en raison d'une faille dans la logique, n'importe quel utilisateur peut ajouter les pilotes sans avoir besoin de privilèges administratifs. Un attaquant peut exploiter la faille et piéger le service pour qu'il installe un pilote permettant l'exécution de commandes sur la machine cible avec les privilèges Système.

## Comment s'en protéger

La première chose à faire est de désactiver le service File d’attente d’impression si votre ordinateur n’a pas d’imprimante. Si vous possédez une imprimante, nous vous recommandons la procédure suivante :

* Accédez à Modifier la stratégie de groupe.
* Allez ensuite dans Configuration de l’ordinateur.
* Cliquez sur Modèles d’administration.
* Sélectionnez Imprimantes.
* Maintenant, nous désactivons Autoriser le gestionnaire de travaux d’impression à accepter les connexions client.
* Et c’est tout, avec cette procédure, vous protégerez votre ordinateur de la vulnérabilité Print Nightmare.
