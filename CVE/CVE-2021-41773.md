# CVE-2021-41773

<br>

> Path traversal attack on Apache HTTP 2.4.49 

<br>

## Aspect technique

<br>

La vulnérabilité peut être exploitée si les fichiers en dehors de la racine du serveur ne sont pas protégés par l’option « require all denied » dans la configuration d’Apache. Lors de cette attaque, il va utiliser le signe “.%2e” qui correspond à “..” en URL encoding afin de remonter dans l'arborescence du serveur. 

(<a href="https://github.com/apache/httpd/commit/e150697086e70c552b2588f369f2d17815cb1782."> https://github.com/apache/httpd/commit/e150697086e70c552b2588f369f2d17815cb1782. </a>)

Si celui-ci veut récupérer le contenu d'un fichier spécifique il peut utilisé burp suite en modifiant la ligne contenant "GET" et en rajoutant le signe précédemment cité dans l'url comme ci dessous :

```
GET /cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd HTTP/1.1
Host: 127.0.0.1
...
```

<iframe width="560" height="315" src="https://www.youtube.com/embed/fLDTc2HHpS4" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<br>


## Vulgarisation

<br>

Cette vulnérabilité critique permet à l'attaquant de remonté sur l'arborescence du serveur et lire le fichier désiré.

<br>

## Correctif

<br>

Il faut mettre à jour Apache HTTP server à une version supérieur notamment la version 2.4.51.

<br>

## Sources 

<br>

- <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-41773"> mitre - CVE-2021-41773 </a>
- <a href="https://www.allistic.fr/cve-2021-41773-analyse-allistic/"> Allistic - CVE-2021-41773 </a>
- <a href="https://vuldb.com/fr/?id.183838"> vuldb - CVE-2021-41773 </a>