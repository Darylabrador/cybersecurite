# CVE-2022-21907

<br>

> Microsoft Windows HTTP Protocol Stack Remote Code Execution

<br>

## Aspect technique

<br>

Le système d'exploitation Microsoft Windows propose un service de gestion des requêtes HTTP sous la forme d'un pilote appelé http.sys. Le pilote http.sys est notamment utilisé par Microsoft IIS, le service Windows Remote Management (WinRM) ainsi que le service SSDP. Il est donc présent sur les serveurs mais également sur les postes de travail. 

Une vulnérabilité a été découverte dans ce pilote pour Windows Server 2019, Windows Server 2022, Windows 10 et Windows 11. Elle permet à un attaquant de provoquer une exécution de code arbitraire à distance en utilisant un paquet spécialement conçu. Microsoft considère qu'elle peut être exploitée dans le cadre d'attaques à propagation de type "ver informatique".

<br>

## Vulgarisation

<br>

Un attaquant non authentifié pourrait envoyer un paquet spécialement conçu à un serveur ciblé en utilisant la pile du protocole HTTP (http.sys) pour traiter les paquets et provoquer une exécution de code arbitraire à distance.

<br>

## Sources 

<br>

- <a href="https://www.cert.ssi.gouv.fr/alerte/CERTFR-2022-ALE-001/"> cert.ssi.gouv.fr </a>
- <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-21907"> msrc.microsoft.com </a>
- <a href="https://vuldb.com/fr/?id.190128"> vuldb.com </a>
- <a href="https://www.cybermalveillance.gouv.fr/tous-nos-contenus/actualites/alerte-cyber-faille-securite-microsoft-windows-windows-server"> cybermalveillance.gouv.fr </a>
- <a href="https://github.com/antx-code/CVE-2022-21907/blob/main/CVE-2022-21907.py"> Proof of concept </a>